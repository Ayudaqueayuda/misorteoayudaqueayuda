<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorteo Din√°mico</title>
    <style>
        /* Aqu√≠ ir√≠a el CSS para el estilo de tu p√°gina */
        body { font-family: sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        input[type="number"], input[type="text"], button { padding: 10px; margin-right: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ddd; }
        button { background-color: #4CAF50; color: white; cursor: pointer; }
        button:hover { opacity: 0.9; }
        #participantesList { list-style: none; padding: 0; }
        #participantesList li { background-color: #f9f9f9; padding: 8px; margin-bottom: 5px; border-radius: 4px; }
        .winner { font-size: 1.2em; font-weight: bold; color: green; margin-top: 20px;}
    </style>
</head>
<body>
  <div id="configuracionSorteo">
    <h1>Organiza tu Sorteo</h1>
    <p>Ingresa la cantidad m√°xima de n√∫meros para el sorteo (Ej: si pones 100, los n√∫meros ir√°n del 1 al 100).</p>
    <input type="number" id="maxNumero" placeholder="Cantidad total de n√∫meros" min="1">
    <button onclick="configurarNumeros()">Configurar N√∫meros</button>
    <hr>
</div>

<div id="registroParticipantes" style="display: none;">
    <h2>Registrar Participante</h2>
<input type="text" id="nombreParticipante" placeholder="Nombre del participante">
<input type="number" id="cantidadBoletos" placeholder="Cantidad de boletos" min="1" value="1"> <button onclick="asignarNumero()">Asignar N√∫mero y Registrar</button>
    <hr>

    <h2>Participantes Registrados</h2>
    <ul id="participantesList">
        </ul>
    <hr>

    <h2>Realizar Sorteo</h2>
    <button onclick="realizarSorteo()">Elegir Ganador</button>
    <div id="ganador" class="winner"></div>
</div>

    <script>
      let numerosTotalesParaSorteo = []; // Almacenar√° los n√∫meros del 1 al maxNumero
let participantes = []; // Almacena { nombre: "Juan", numeros: [1, 5, 20] }
let boletosRegistrados = {}; // Nuevo: Asocia cada n√∫mero asignado a su participante { '1': 'Juan', '5': 'Juan', '20': 'Juan', ... }
let maxNumberConfigured = 0;

function configurarNumeros() {
    maxNumberConfigured = parseInt(document.getElementById('maxNumero').value);
    if (isNaN(maxNumberConfigured) || maxNumberConfigured <= 0) {
        alert('Por favor, ingresa un n√∫mero v√°lido y mayor que cero para la cantidad de n√∫meros.');
        return;
    }
    // Ahora se inicializa numerosTotalesParaSorteo
    numerosTotalesParaSorteo = Array.from({length: maxNumberConfigured}, (_, i) => i + 1); // Crea un array de 1 a maxNumero
    alert(`Sorteo configurado con ${maxNumberConfigured} n√∫meros.`);

    document.getElementById('configuracionSorteo').style.display = 'none';
    document.getElementById('registroParticipantes').style.display = 'block';
}

function asignarNumero() {
    const nombre = document.getElementById('nombreParticipante').value.trim();
    const cantidadBoletos = parseInt(document.getElementById('cantidadBoletos').value);

    if (!nombre) {
        alert('Por favor, ingresa el nombre del participante.');
        return;
    }

    if (isNaN(cantidadBoletos) || cantidadBoletos <= 0) {
        alert('Por favor, ingresa una cantidad v√°lida de boletos (al menos 1).');
        return;
    }

    if (maxNumberConfigured === 0) {
        alert('Por favor, configura la cantidad total de n√∫meros antes de asignar.');
        return;
    }

    // Obtener los n√∫meros que a√∫n no han sido asignados
    let numerosDisponiblesParaAsignar = numerosTotalesParaSorteo.filter(num => !boletosRegistrados[num]);

    if (numerosDisponiblesParaAsignar.length === 0) {
        alert('¬°Se han asignado todos los n√∫meros disponibles! No hay m√°s n√∫meros para repartir.');
        return;
    }

    if (cantidadBoletos > numerosDisponiblesParaAsignar.length) {
        alert(`No hay suficientes n√∫meros disponibles para asignar ${cantidadBoletos} boletos. Solo quedan ${numerosDisponiblesParaAsignar.length}.`);
        return;
    }

    let boletosAsignados = [];
    for (let i = 0; i < cantidadBoletos; i++) {
        const indiceAleatorio = Math.floor(Math.random() * numerosDisponiblesParaAsignar.length);
        const numeroAsignado = numerosDisponiblesParaAsignar[indiceAleatorio];

        // A√±adir el n√∫mero asignado a boletosRegistrados con el nombre del participante
        boletosRegistrados[numeroAsignado] = nombre; // CLAVE: Asocia el n√∫mero con el nombre

        boletosAsignados.push(numeroAsignado);

        // Eliminar el n√∫mero asignado de la lista temporal para la asignaci√≥n actual
        numerosDisponiblesParaAsignar.splice(indiceAleatorio, 1);
    }

    participantes.push({ nombre: nombre, numeros: boletosAsignados });

    const lista = document.getElementById('participantesList');
    const nuevoItem = document.createElement('li');
    nuevoItem.textContent = `${nombre} - N√∫meros: ${boletosAsignados.join(', ')}`;
    lista.appendChild(nuevoItem);

    document.getElementById('nombreParticipante').value = '';
    document.getElementById('cantidadBoletos').value = '1';
}

function realizarSorteo() {
    // Asegurarse de que haya boletos registrados en el sorteo
    const numerosComprados = Object.keys(boletosRegistrados).map(Number); // Convertir claves de objeto a array de n√∫meros
    if (numerosComprados.length === 0) {
        alert('No se han vendido boletos a√∫n. Registra participantes.');
        return;
    }

    // Seleccionar un n√∫mero de boleto ganador al azar de los que han sido comprados
    const indiceBoletoGanador = Math.floor(Math.random() * numerosComprados.length);
    const numeroGanador = numerosComprados[indiceBoletoGanador];

    // Identificar al participante que compr√≥ ese n√∫mero
    const nombreGanador = boletosRegistrados[numeroGanador];

    const divGanador = document.getElementById('ganador');
    divGanador.textContent = `¬°El n√∫mero ganador es el: ${numeroGanador}! üéâ Pertenece a: ${nombreGanador}.`;
}
    </script>
</body>
</html>